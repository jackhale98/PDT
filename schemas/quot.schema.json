{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://pdt.dev/schemas/quote.schema.json",
  "title": "Quote",
  "description": "A supplier quote for a component or assembly",
  "type": "object",
  "required": ["id", "title", "supplier", "status", "created", "author"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^QUOT-[0-9A-Z]{26}$",
      "description": "Unique identifier (QUOT prefix + ULID)"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "description": "Quote title/description"
    },
    "supplier": {
      "type": "string",
      "description": "Supplier ID (SUP-...)"
    },
    "component": {
      "type": ["string", "null"],
      "description": "Component ID this quote is for (mutually exclusive with assembly)"
    },
    "assembly": {
      "type": ["string", "null"],
      "description": "Assembly ID this quote is for (mutually exclusive with component)"
    },
    "quote_ref": {
      "type": ["string", "null"],
      "description": "Supplier's quote reference number"
    },
    "description": {
      "type": ["string", "null"],
      "description": "Detailed description or notes"
    },
    "currency": {
      "type": "string",
      "enum": ["USD", "EUR", "GBP", "CNY", "JPY"],
      "default": "USD",
      "description": "Currency for all prices"
    },
    "price_breaks": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "min_qty": { "type": "integer", "minimum": 1 },
          "unit_price": { "type": "number" },
          "lead_time_days": { "type": ["integer", "null"] }
        },
        "required": ["min_qty", "unit_price"]
      },
      "description": "Price breaks (quantity-based pricing)"
    },
    "moq": {
      "type": ["integer", "null"],
      "minimum": 1,
      "description": "Minimum order quantity"
    },
    "tooling_cost": {
      "type": ["number", "null"],
      "description": "Tooling cost (one-time)"
    },
    "nre_costs": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "description": { "type": "string" },
          "cost": { "type": "number" },
          "one_time": { "type": "boolean", "default": false }
        },
        "required": ["description", "cost"]
      },
      "description": "Non-recurring engineering costs"
    },
    "lead_time_days": {
      "type": ["integer", "null"],
      "description": "Standard lead time in days"
    },
    "quote_date": {
      "type": ["string", "null"],
      "format": "date",
      "description": "Date quote was received"
    },
    "valid_until": {
      "type": ["string", "null"],
      "format": "date",
      "description": "Date quote expires"
    },
    "quote_status": {
      "type": "string",
      "enum": ["pending", "received", "accepted", "rejected", "expired"],
      "default": "pending",
      "description": "Quote-specific status"
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Tags for filtering"
    },
    "status": {
      "type": "string",
      "enum": ["draft", "review", "approved", "released", "obsolete"],
      "description": "Entity status"
    },
    "links": {
      "type": "object",
      "properties": {
        "related_quotes": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Related quotes (e.g., competing quotes)"
        }
      }
    },
    "created": {
      "type": "string",
      "format": "date-time",
      "description": "Creation timestamp"
    },
    "author": {
      "type": "string",
      "description": "Author name"
    },
    "entity_revision": {
      "type": "integer",
      "minimum": 1,
      "default": 1,
      "description": "Entity revision number"
    }
  },
  "additionalProperties": true
}
